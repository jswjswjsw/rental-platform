<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>支付功能测试</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px; 
            background-color: #f5f5f5;
        }
        .test-container { 
            background: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .pay-button { 
            background: #07c160; 
            color: white; 
            border: none; 
            padding: 15px 30px; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 16px; 
            margin: 10px; 
        }
        .pay-button:hover { background: #06ad56; }
        .pay-button:disabled { background: #c0c4cc; cursor: not-allowed; }
        .result { 
            margin-top: 20px; 
            padding: 15px; 
            border-radius: 4px; 
            font-family: monospace; 
            white-space: pre-wrap; 
        }
        .success { background: #f0f9ff; border: 1px solid #409eff; color: #409eff; }
        .error { background: #fef0f0; border: 1px solid #f56c6c; color: #f56c6c; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔧 支付功能测试页面</h1>
        <p>这个页面用来测试修复后的支付按钮功能</p>
        <h3>测试按钮</h3>
        <button class="pay-button" onclick="testPaymentClick()">测试支付按钮点击</button>
        <button class="pay-button" onclick="testAsyncPayment()">测试异步支付流程</button>
        <button class="pay-button" onclick="testEnvironmentCheck()">测试环境变量</button>
        <div id="result" class="result">点击上方按钮开始测试...</div>
    </div>
    <script>
        function updateResult(message, type = 'success') {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result ' + type;
            resultDiv.textContent = message;
            console.log('[' + type.toUpperCase() + '] ' + message);
        }
        
        function testPaymentClick() {
            console.log('🔄 支付按钮被点击', { paymentType: 'rent', orderId: 'test-123', paying: false });
            updateResult('✅ 支付按钮点击测试成功！\n控制台已输出调试日志。', 'success');
        }
        
        async function testAsyncPayment() {
            updateResult('⏳ 测试异步支付流程...', 'success');
            try {
                console.log('📝 开始创建支付订单', { orderId: 'test-123', paymentType: 'rent' });
                await new Promise(function(resolve) { setTimeout(resolve, 1000); });
                console.log('开发环境：模拟微信支付成功');
                await new Promise(function(resolve) { setTimeout(resolve, 1000); });
                updateResult('✅ 异步支付流程测试成功！\n所有步骤都正常执行。', 'success');
            } catch (error) {
                updateResult('❌ 支付流程测试失败：' + error.message, 'error');
            }
        }
        
        function testEnvironmentCheck() {
            const isDev = true; // 模拟 import.meta.env.DEV
            console.log('环境检查:', { isDev, userAgent: navigator.userAgent });
            updateResult('✅ 环境变量测试成功！\n开发环境: ' + isDev + '\n用户代理: ' + navigator.userAgent, 'success');
        }
        
        console.log('🔧 支付功能测试页面已加载');
        console.log('💡 这个页面模拟了修复后的支付功能');
    </script>
</body>
</html>